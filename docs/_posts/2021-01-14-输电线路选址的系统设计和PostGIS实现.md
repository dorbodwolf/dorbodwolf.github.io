    本文档由MacOS的Pages文稿转换而来，转换步骤如下：

    1）首先将Pages文稿导出为rtfd格式。rtfd是包含附件的RTF格式，存储方式是在一个目录下包含一个RTF文件和一些图片附件等；

    2）将rtfd目录中的RTF文件转换为html文件，这个步骤由MacOS原生的textutil工具完成，具体用法可以通过`man textutile`查看，转换命令如下：

    `textutil foo.rtfd/TXT.rtf -convert html`

    这一步转换丢弃了Pages文稿中的图片附件。

    3）将html文件转换为strict markdown文件，这一步基于pandoc工具，可以直接下载Mac安装包安装，转换命令如下：

    `pandoc --from html --to markdown_strict foo.rtfd/TXT.html -o foo.md`


**Topic**

  

Fire risk of electric assets

  

输电廊道上的潜在环境风险（特别是火灾）管控

  

**Nested asset types**

  

**Level1<span class="Apple-converted-space"> </span>**

  

Land Use mask layer

  

**Level2**<span class="Apple-converted-space"> </span>

  

Power transmission corridor

  

**Level3**<span class="Apple-converted-space"> </span>

  

Power lines

  

Tower

  

trees

  

<span class="s1">Weather station</span>

  

  

  

  

  

  

  

  

**Title**

  

Environmental risk prevention of power transmission facilities

  

**Aims**

  

为电力单位的植被管理团队提供关于资产的计划、实践和报告的精确模型，来简化他们高成本和复杂的现场数据收集和检查工作。我们希望帮助电力设施维护团队优化工作流程并降低业务成本。

Provide the vegetation management team of the electricity agency with
accurate models of asset planning, practice and reporting to simplify
their high-cost and complex field data collection and inspection work.
We hope to help the power facility maintenance team optimize work
processes and reduce business costs.

  

电力单位无法通过例行的野外作业来预测哪些资产需要修护或清理。希望帮助他们根据周围环境评估周围环境的状况，特别是输电廊道上植被的空间特征，预测这些环境因子的变化，来感知对公用事业资产的威胁。<span
class="s2"> </span>

The electricity agency cannot predict which assets need repairing or
cleaning through routine field operations. Hope to help them assess the
condition of the surrounding environment based on the surrounding
environment, especially the spatial characteristics of the vegetation on
the power transmission corridor, predict the changes of these
environmental factors, and perceive the threat to public utility
assets.<span class="Apple-converted-space"> </span>

 

为电力单位提供快速高效的数据收集和检查<span
class="s3">、</span>提升数据准确性和质量<span
class="s3">、</span>帮助他们实现有效的团队协调与协作。我们旨在通过分析挖掘空间数据，来帮助电力单位识别和预测环境危害例如野火，评估经济<span
class="s3">损失</span>。

To provide electricity agency with fast and efficient data collection
and inspection, improve data accuracy and quality, and help them achieve
effective team coordination and collaboration. We aim to analyze and
mining spatial data to help power companies identify and predict
environmental hazards such as wildfires and assess economic losses.

  

**Decisions**

初步构思的决策项（功能点）  

1.  <span
    class="s2"></span>为了安全，廊道内房屋都要被拆迁，总共涉及多少栋房屋，总共需要赔偿多少钱？
2.  <span
    class="s2"></span>为了安全，廊道内的耕地都要被弃用，廊道内的耕地面积有多少，涉及的土地价值有多少？
3.  <span class="s2"></span>**距离故障输电塔**<span
    class="s2">**5**</span>**公里内的居民区有多少个？**
4.  <span class="s2"></span><span
    class="s4">**有多少条道路需要设置警示牌来注意高压危险？**</span>
5.  <span class="s2"></span><span
    class="s4">**输电廊道上需要砍掉的离输电线路太近的树木有多少颗？**</span>
6.  <span
    class="s2"></span>输电廊道上哪些树木因为靠近输电线路而需要修剪？
7.  <span class="s2"></span>所有输电廊道<span
    class="s2">1</span>公里缓冲区内的用地类型有哪些？用地面积占比最大的和最小的用地类型分别是什么？
8.  <span class="s2"></span>按照受树木干扰威胁程度对编号为<span
    class="s2">A001</span>对输电线路上的所有输电塔排序，并给出前三个输电塔之间的距离？
9.  <span class="s2"></span>编号为<span
    class="s2">X003</span>的输电廊道单位面积的输电塔个数是多少？单位长度的树木个数是多少？


**Pyramid**

![pyramid](https://raw.githubusercontent.com/dorbodwolf/graphs_from_draw.io/0bb4c1a1143a1631a48abe9047feec63430bbd9d/watersupply.svg)

**ER diagram**

![er](https://raw.githubusercontent.com/dorbodwolf/graphs_from_draw.io/4909262b126d5bc59d2bca1cf4461d7843e60280/watersupply_er.svg)

**Tables**


<table class="t1" data-cellspacing="0" data-cellpadding="0">
<colgroup>
<col style="width: 11%" />
<col style="width: 11%" />
<col style="width: 11%" />
<col style="width: 11%" />
<col style="width: 11%" />
<col style="width: 11%" />
<col style="width: 11%" />
<col style="width: 11%" />
<col style="width: 11%" />
</colgroup>
<tbody>
<tr class="odd">
<td><p><strong>Column</strong></p></td>
<td><p><strong>Details</strong></p></td>
<td><p><strong>Type</strong></p></td>
<td><p><strong>Not null cons</strong></p></td>
<td><p><strong>Unique cons</strong></p></td>
<td><p><strong>Primary key</strong></p></td>
<td><p><strong>Foreign key</strong></p></td>
<td><p><strong>Check</strong></p></td>
<td><p><strong>Exclusion</strong></p></td>
</tr>
<tr class="even">
<td><p>ID</p></td>
<td><p><br />
</p></td>
<td><p>integer</p></td>
<td><p>Y</p></td>
<td><p>Y</p></td>
<td><p>Y</p></td>
<td><p><br />
</p></td>
<td><p><br />
</p></td>
<td><p><br />
</p></td>
</tr>
<tr class="odd">
<td><p>LUTYPE</p></td>
<td><p>Land use types:</p>
<p><br />
</p>
<p><span class="Apple-converted-space"> </span>forest</p>
<p><span class="Apple-converted-space"> </span>residential</p>
<p><span class="Apple-converted-space"> </span>road</p>
<p><span class="Apple-converted-space"> </span>facilities farmland</p>
<p><span class="Apple-converted-space"> </span>water</p>
<p>industrial</p></td>
<td><p>varchar(50)</p></td>
<td><p>Y</p></td>
<td><p><br />
</p></td>
<td><p><br />
</p></td>
<td><p><br />
</p></td>
<td><p><br />
</p></td>
<td><p><br />
</p></td>
</tr>
<tr class="even">
<td><p>PEOPLE</p></td>
<td><p>How many people in the block</p></td>
<td><p>bigint</p></td>
<td><p><br />
</p></td>
<td><p><br />
</p></td>
<td><p><br />
</p></td>
<td><p><br />
</p></td>
<td><p><br />
</p></td>
<td><p><br />
</p></td>
</tr>
<tr class="odd">
<td><p>HOUSE</p></td>
<td><p>How many house in the block</p></td>
<td><p>bigint</p></td>
<td><p><br />
</p></td>
<td><p><br />
</p></td>
<td><p><br />
</p></td>
<td><p><br />
</p></td>
<td><p><br />
</p></td>
<td><p><br />
</p></td>
</tr>
<tr class="even">
<td><p>geom</p></td>
<td><p>Geometry</p></td>
<td><p><br />
</p></td>
<td><p><br />
</p></td>
<td><p><br />
</p></td>
<td><p><br />
</p></td>
<td><p><br />
</p></td>
<td><p><br />
</p></td>
<td><p><br />
</p></td>
</tr>
</tbody>
</table>

  

  

<table class="t1" data-cellspacing="0" data-cellpadding="0">
<colgroup>
<col style="width: 11%" />
<col style="width: 11%" />
<col style="width: 11%" />
<col style="width: 11%" />
<col style="width: 11%" />
<col style="width: 11%" />
<col style="width: 11%" />
<col style="width: 11%" />
<col style="width: 11%" />
</colgroup>
<tbody>
<tr class="odd">
<td><p><strong>Column</strong></p></td>
<td><p><strong>Details</strong></p></td>
<td><p><strong>Type</strong></p></td>
<td><p><strong>Not null cons</strong></p></td>
<td><p><strong>Unique cons</strong></p></td>
<td><p><strong>Primary key</strong></p></td>
<td><p><strong>Foreign key</strong></p></td>
<td><p><strong>Check</strong></p></td>
<td><p><strong>Exclusion</strong></p></td>
</tr>
<tr class="even">
<td><p>ID</p></td>
<td><p><br />
</p></td>
<td><p>integer</p></td>
<td><p>Y</p></td>
<td><p>Y</p></td>
<td><p>Y</p></td>
<td><p><br />
</p></td>
<td><p><br />
</p></td>
<td><p><br />
</p></td>
</tr>
<tr class="odd">
<td><p>geom</p></td>
<td><p>Geometry</p></td>
<td><p><br />
</p></td>
<td><p><br />
</p></td>
<td><p><br />
</p></td>
<td><p><br />
</p></td>
<td><p><br />
</p></td>
<td><p><br />
</p></td>
<td><p><br />
</p></td>
</tr>
<tr class="even">
<td><p><br />
</p></td>
<td><p><br />
</p></td>
<td><p><br />
</p></td>
<td><p><br />
</p></td>
<td><p><br />
</p></td>
<td><p><br />
</p></td>
<td><p><br />
</p></td>
<td><p><br />
</p></td>
<td><p><br />
</p></td>
</tr>
<tr class="odd">
<td><p><br />
</p></td>
<td><p><br />
</p></td>
<td><p><br />
</p></td>
<td><p><br />
</p></td>
<td><p><br />
</p></td>
<td><p><br />
</p></td>
<td><p><br />
</p></td>
<td><p><br />
</p></td>
<td><p><br />
</p></td>
</tr>
</tbody>
</table>

  

  

  

  

  

  

  

  

  

  

  

  

<table class="t1" data-cellspacing="0" data-cellpadding="0">
<colgroup>
<col style="width: 11%" />
<col style="width: 11%" />
<col style="width: 11%" />
<col style="width: 11%" />
<col style="width: 11%" />
<col style="width: 11%" />
<col style="width: 11%" />
<col style="width: 11%" />
<col style="width: 11%" />
</colgroup>
<tbody>
<tr class="odd">
<td><p><strong>Column</strong></p></td>
<td><p><strong>Details</strong></p></td>
<td><p><strong>Type</strong></p></td>
<td><p><strong>Not null cons</strong></p></td>
<td><p><strong>Unique cons</strong></p></td>
<td><p><strong>Primary key</strong></p></td>
<td><p><strong>Foreign key</strong></p></td>
<td><p><strong>Check</strong></p></td>
<td><p><strong>Exclusion</strong></p></td>
</tr>
<tr class="even">
<td><p>ID</p></td>
<td><p><br />
</p></td>
<td><p>integer</p></td>
<td><p>Y</p></td>
<td><p>Y</p></td>
<td><p>Y</p></td>
<td><p><br />
</p></td>
<td><p><br />
</p></td>
<td><p><br />
</p></td>
</tr>
<tr class="odd">
<td><p>TEXTURE</p></td>
<td><p>texture of electrical wire</p>
<p>“A”</p>
<p>“B”</p>
<p>“C”</p></td>
<td><p>varchar(50)</p></td>
<td><p>Y</p></td>
<td><p><br />
</p></td>
<td><p><br />
</p></td>
<td><p><br />
</p></td>
<td><p><br />
</p></td>
<td><p><br />
</p></td>
</tr>
<tr class="even">
<td><p>LPARALLEL</p></td>
<td><p>Parallel lines of a electrical wire</p></td>
<td><p>integer</p></td>
<td><p>Y</p></td>
<td><p><br />
</p></td>
<td><p><br />
</p></td>
<td><p><br />
</p></td>
<td><p><br />
</p></td>
<td><p><br />
</p></td>
</tr>
<tr class="odd">
<td><p>geom</p></td>
<td><p><br />
</p></td>
<td><p><br />
</p></td>
<td><p><br />
</p></td>
<td><p><br />
</p></td>
<td><p><br />
</p></td>
<td><p><br />
</p></td>
<td><p><br />
</p></td>
<td><p><br />
</p></td>
</tr>
</tbody>
</table>

  

<table class="t1" data-cellspacing="0" data-cellpadding="0">
<colgroup>
<col style="width: 11%" />
<col style="width: 11%" />
<col style="width: 11%" />
<col style="width: 11%" />
<col style="width: 11%" />
<col style="width: 11%" />
<col style="width: 11%" />
<col style="width: 11%" />
<col style="width: 11%" />
</colgroup>
<tbody>
<tr class="odd">
<td><p><strong>Column</strong></p></td>
<td><p><strong>Details</strong></p></td>
<td><p><strong>Type</strong></p></td>
<td><p><strong>Not null cons</strong></p></td>
<td><p><strong>Unique cons</strong></p></td>
<td><p><strong>Primary key</strong></p></td>
<td><p><strong>Foreign key</strong></p></td>
<td><p><strong>Check</strong></p></td>
<td><p><strong>Exclusion</strong></p></td>
</tr>
<tr class="even">
<td><p>ID</p></td>
<td><p><br />
</p></td>
<td><p>integer</p></td>
<td><p>Y</p></td>
<td><p>Y</p></td>
<td><p>Y</p></td>
<td><p><br />
</p></td>
<td><p><br />
</p></td>
<td><p><br />
</p></td>
</tr>
<tr class="odd">
<td><p>HEIGHT</p></td>
<td><p>Height of tower(meter</p></td>
<td><p>decimal</p></td>
<td><p>Y</p></td>
<td><p><br />
</p></td>
<td><p><br />
</p></td>
<td><p><br />
</p></td>
<td><p><br />
</p></td>
<td><p><br />
</p></td>
</tr>
<tr class="even">
<td><p>TEXTURE</p></td>
<td><p>Texture of tower include Q235 Q345 Q460</p></td>
<td><p>varchar(50)</p></td>
<td><p><br />
</p></td>
<td><p><br />
</p></td>
<td><p><br />
</p></td>
<td><p><br />
</p></td>
<td><p><br />
</p></td>
<td><p><br />
</p></td>
</tr>
<tr class="odd">
<td><p>CORROSION</p></td>
<td><p>loss ratio of sectional area in ten years.<span class="Apple-converted-space">  </span>include</p>
<p><span class="Apple-converted-space"> </span>in[0,1]</p>
<p><br />
</p></td>
<td><p>decimal</p></td>
<td><p><br />
</p></td>
<td><p><br />
</p></td>
<td><p><br />
</p></td>
<td><p><br />
</p></td>
<td><p><br />
</p></td>
<td><p><br />
</p></td>
</tr>
<tr class="even">
<td><p>geom</p></td>
<td><p>Geometry</p></td>
<td><p><br />
</p></td>
<td><p><br />
</p></td>
<td><p><br />
</p></td>
<td><p><br />
</p></td>
<td><p><br />
</p></td>
<td><p><br />
</p></td>
<td><p><br />
</p></td>
</tr>
<tr class="odd">
<td><p>WIRES_ID</p></td>
<td><p><br />
</p></td>
<td><p><br />
</p></td>
<td><p><br />
</p></td>
<td><p><br />
</p></td>
<td><p><br />
</p></td>
<td><p>Y</p></td>
<td><p><br />
</p></td>
<td><p><br />
</p></td>
</tr>
</tbody>
</table>

  

<table class="t1" data-cellspacing="0" data-cellpadding="0">
<colgroup>
<col style="width: 11%" />
<col style="width: 11%" />
<col style="width: 11%" />
<col style="width: 11%" />
<col style="width: 11%" />
<col style="width: 11%" />
<col style="width: 11%" />
<col style="width: 11%" />
<col style="width: 11%" />
</colgroup>
<tbody>
<tr class="odd">
<td><p><strong>Column</strong></p></td>
<td><p><strong>Details</strong></p></td>
<td><p><strong>Type</strong></p></td>
<td><p><strong>Not null cons</strong></p></td>
<td><p><strong>Unique cons</strong></p></td>
<td><p><strong>Primary key</strong></p></td>
<td><p><strong>Foreign key</strong></p></td>
<td><p><strong>Check</strong></p></td>
<td><p><strong>Exclusion</strong></p></td>
</tr>
<tr class="even">
<td><p>ID</p></td>
<td><p><br />
</p></td>
<td><p>integer</p></td>
<td><p>Y</p></td>
<td><p>Y</p></td>
<td><p>Y</p></td>
<td><p><br />
</p></td>
<td><p><br />
</p></td>
<td><p><br />
</p></td>
</tr>
<tr class="odd">
<td><p>TREETYPE</p></td>
<td><p>varieties of trees</p>
<p>“A”</p>
<p>“B”</p>
<p>“C”</p>
<p>“D”</p>
<p>“E”</p></td>
<td><p>varchar(50)</p></td>
<td><p><br />
</p></td>
<td><p><br />
</p></td>
<td><p><br />
</p></td>
<td><p><br />
</p></td>
<td><p><br />
</p></td>
<td><p><br />
</p></td>
</tr>
<tr class="even">
<td><p>AGE</p></td>
<td><p>How old of the tree</p>
<p>1-100</p></td>
<td><p>integer</p></td>
<td><p><br />
</p></td>
<td><p><br />
</p></td>
<td><p><br />
</p></td>
<td><p><br />
</p></td>
<td><p><br />
</p></td>
<td><p><br />
</p></td>
</tr>
<tr class="odd">
<td><p>geom</p></td>
<td><p>Geometry</p></td>
<td><p><br />
</p></td>
<td><p><br />
</p></td>
<td><p><br />
</p></td>
<td><p><br />
</p></td>
<td><p><br />
</p></td>
<td><p><br />
</p></td>
<td><p><br />
</p></td>
</tr>
<tr class="even">
<td><p><br />
</p></td>
<td><p><br />
</p></td>
<td><p><br />
</p></td>
<td><p><br />
</p></td>
<td><p><br />
</p></td>
<td><p><br />
</p></td>
<td><p><br />
</p></td>
<td><p><br />
</p></td>
<td><p><br />
</p></td>
</tr>
</tbody>
</table>

  

**SQL**

  

这部分内容应参考<span class="s2">postgis</span>官方文档。

  

创建表之前需要创建数据库，应用<span class="s2">postgis</span>扩展。

  

<span class="s5">Create table</span>

  

QGIS<span class="s4">创建的</span>polygon<span
class="s4">和</span>linestring<span
class="s4">类型的要素类默认是</span>multi<span
class="s4">型的，所以创建表时</span>geom<span
class="s4">字段也要对应带</span>multi<span class="s4">的类型。</span>

  

(base) <span class="s6">jade\_mayer</span> in <span
class="s7">~/projects/lhx/asset/work/sql</span><span class="s8">
λ</span> psql -d electric -f createtable\_ucfsxxx.sql

创建表前先删除shema及其下面的table，保证每次测试从头开始，直到成功。同时，每次执行sql语句都按事务提交，这样发生错误会自动回滚操作，sql脚本如下：

```sql
BEGIN;

DROP SCHEMA IF EXISTS ucfsxxx CASCADE; -- drop the schema and its table
CREATE SCHEMA ucfsxxx;
create table ucfsxxx.landuse (ID serial, LUTYPE varchar(50), PEOPLE bigint, HOUSE bigint, geom geometry(MULTIPOLYGON, 32649) );
create table ucfsxxx.corridors (ID serial, geom geometry(MULTIPOLYGON, 32649) );
create table ucfsxxx.wires (ID serial, TEXTURE varchar(50), LPARALLEL integer, geom geometry(MultiLineString, 32649) );
create table ucfsxxx.towers (ID serial, HEIGHT decimal, TEXTURE varchar(50), CORROSION decimal, geom geometry(POINT, 32649), WIRES_ID integer );
create table ucfsxxx.trees (ID serial, TREETYPE varchar(50), AGE integer, geom geometry(POINT, 32649) );

COMMIT; 

```

<span class="s5">Create constraints</span>



(base) <span class="s6">jade\_mayer</span> in <span
class="s7">~/projects/lhx/asset/work/sql</span><span class="s8">
λ</span> psql -d electric -f createconstraints\_ucfsxxx.sql

单独创建约束，包括主键和外键约束。

```sql
BEGIN;

ALTER TABLE ucfsxxx.landuse DROP CONSTRAINT IF EXISTS landuse_pkey;
ALTER TABLE ucfsxxx.landuse ADD CONSTRAINT landuse_pkey PRIMARY KEY (ID);

ALTER TABLE ucfsxxx.corridors DROP CONSTRAINT IF EXISTS corridors_pkey;
ALTER TABLE ucfsxxx.corridors ADD CONSTRAINT corridors_pkey PRIMARY KEY (ID);

ALTER TABLE ucfsxxx.wires DROP CONSTRAINT IF EXISTS wires_pkey;
ALTER TABLE ucfsxxx.wires ADD CONSTRAINT wires_pkey PRIMARY KEY (ID);

ALTER TABLE ucfsxxx.towers DROP CONSTRAINT IF EXISTS towers_pkey;
ALTER TABLE ucfsxxx.towers ADD CONSTRAINT towers_pkey PRIMARY KEY (ID);

-- foreign key adding process
ALTER TABLE ucfsxxx.towers DROP CONSTRAINT IF EXISTS towers_fkey;
ALTER TABLE ucfsxxx.towers 
	ADD CONSTRAINT towers_fkey FOREIGN KEY (WIRES_ID)
	REFERENCES ucfsxxx.wires (ID)
	ON DELETE CASCADE;

ALTER TABLE ucfsxxx.trees DROP CONSTRAINT IF EXISTS trees_pkey;
ALTER TABLE ucfsxxx.trees ADD CONSTRAINT trees_pkey PRIMARY KEY (ID);

COMMIT;

```

<span class="s5">Insert data</span>

在QGIS中随机生成实验数据，用到不少技巧，包括在属性表字段计算器中自定义Python函数对属性赋值。

![qgis截图]()

1\)

  

(base) <span class="s6">jade\_mayer</span> in <span
class="s7">~/projects/lhx/asset/work/sql</span><span class="s8">
λ</span> shp2pgsql -a -s 32649 -I ../../data/electric/landusegrid.shp
ucfsxxx.landuse &gt; insertdata\_ucfsxxx\_landuse.sql

  

(base) <span class="s6">jade\_mayer</span> in <span
class="s7">~/projects/lhx/asset/work/sql</span><span class="s8">
λ</span> psql -d electric -f insertdata\_ucfsxxx\_landuse.sql

  

2\)

  

(base) <span class="s4">╭</span>─<span
class="s9">jade\_mayer</span><span class="s10">@</span><span
class="s9">jadedeMacBook-Pro.local</span>
**~/projects/lhx/asset/work/sql** <span
class="Apple-converted-space"> </span>

<span class="s4">╰</span>─<span class="s11">➤</span><span
class="Apple-converted-space">  </span>shp2pgsql -a -s 32649 -I
../../data/electric/corridor.shp ucfsxxx.corridors &gt;
insertdata\_ucfsxxx\_corridors.sql

  

(base) <span class="s4">╭</span>─<span
class="s9">jade\_mayer</span><span class="s10">@</span><span
class="s9">jadedeMacBook-Pro.local</span>
**~/projects/lhx/asset/work/sql** <span
class="Apple-converted-space"> </span>

<span class="s4">╰</span>─<span class="s11">➤</span><span
class="Apple-converted-space">  </span>psql -d electric -f
insertdata\_ucfsxxx\_corridors.sql<span
class="Apple-converted-space"> </span>

3\)

  

(base) <span class="s4">╭</span>─<span
class="s9">jade\_mayer</span><span class="s10">@</span><span
class="s9">jadedeMacBook-Pro.local</span>
**~/projects/lhx/asset/work/sql** <span
class="Apple-converted-space"> </span>

<span class="s4">╰</span>─<span class="s11">➤</span><span
class="Apple-converted-space">  </span>shp2pgsql -a -s 32649 -I
../../data/electric/lines.shp ucfsxxx.wires &gt;
insertdata\_ucfsxxx\_wires.sql <span class="Apple-converted-space"> 
 </span>

Shapefile type: Arc

Postgis type: MULTILINESTRING\[2\]

  

(base) <span class="s4">╭</span>─<span
class="s9">jade\_mayer</span><span class="s10">@</span><span
class="s9">jadedeMacBook-Pro.local</span>
**~/projects/lhx/asset/work/sql** <span
class="Apple-converted-space"> </span>

<span class="s4">╰</span>─<span class="s11">➤</span><span
class="Apple-converted-space">  </span>psql -d electric -f
insertdata\_ucfsxxx\_wires.sql <span class="Apple-converted-space"> 
 </span>

SET

SET

BEGIN

INSERT 0 1

INSERT 0 1

INSERT 0 1

CREATE INDEX

COMMIT

ANALYZE

  

4\)

  

(base) <span class="s4">╭</span>─<span
class="s9">jade\_mayer</span><span class="s10">@</span><span
class="s9">jadedeMacBook-Pro.local</span>
**~/projects/lhx/asset/work/sql** <span
class="Apple-converted-space"> </span>

<span class="s4">╰</span>─<span class="s11">➤</span><span
class="Apple-converted-space">  </span>shp2pgsql -a -s 32649 -I
../../data/electric/tower.shp ucfsxxx.towers &gt;
insertdata\_ucfsxxx\_towers.sql

<span class="s12"></span>  

(base) <span class="s4">╭</span>─<span
class="s9">jade\_mayer</span><span class="s10">@</span><span
class="s9">jadedeMacBook-Pro.local</span>
**~/projects/lhx/asset/work/sql** <span
class="Apple-converted-space"> </span>

<span class="s4">╰</span>─<span class="s11">➤</span><span
class="Apple-converted-space">  </span>psql -d electric -f
insertdata\_ucfsxxx\_towers.sql<span class="Apple-converted-space"> 
 </span>

  

5\)

  

(base) <span class="s4">╭</span>─<span
class="s9">jade\_mayer</span><span class="s10">@</span><span
class="s9">jadedeMacBook-Pro.local</span>
**~/projects/lhx/asset/work/sql** <span
class="Apple-converted-space"> </span>

<span class="s4">╰</span>─<span class="s11">➤</span><span
class="Apple-converted-space">  </span>shp2pgsql -a -s 32649 -I
../../data/electric/trees.shp ucfsxxx.trees &gt;
insertdata\_ucfsxxx\_trees.sql<span
class="Apple-converted-space"> </span>

  

(base) <span class="s4">╭</span>─<span
class="s9">jade\_mayer</span><span class="s10">@</span><span
class="s9">jadedeMacBook-Pro.local</span>
**~/projects/lhx/asset/work/sql** <span
class="Apple-converted-space"> </span>

<span class="s4">╰</span>─<span class="s11">➤</span><span
class="Apple-converted-space">  </span>psql -d electric -f
insertdata\_ucfsxxx\_trees.sql <span
class="Apple-converted-space"> </span>

  

<span class="s5">Query data</span>

到此为止，数据库已经建好。接下来就是细化每个<span
class="s13">decision</span>，给出在数据库中的查询语句。

描述：新建三条输电线路，一条是东北<span
class="s13">-</span>西南走向，另外两条是西北<span
class="s13">-</span>东南走向。每条线路都要占用一定范围的土地，称为输电走廊。

**Decision 1**

在输电廊道和道路交叉口的两端要分别设置两个警示牌（每个交叉口共需要设置<span
class="s13">4</span>个警示牌），提醒过往行人车辆注意安全。请问修建这三条输电线路后总共需要设置多少个道路警示牌？

所属层：输电廊道层

**Decision 2**

  

假设只有居民区会统计人口数据，来评估三条输电廊道内会影响多少人的生活（某个居民区受影响人数按照通电廊道侵占居民区的面积占居民区的总面积比例换算）。输电廊道会经过的居民区的编号和人口数分别是？每个居民区受输电廊道影响面积占居民区总面积比例是多少？估算每个居民区受影响的人口分别是多少？

  

所属层：用地类型层

  

**Decision 3**

  

三条输电线路的材料费造价是多少？输电线路包括输电线缆和铁塔，一条线路可能有多条并行线缆。输电线缆材质类型<span
class="s2">A</span>，<span class="s2">B</span>，<span
class="s2">C</span>的每公里价格分别是<span class="s2">3000</span>，<span
class="s2"> 5000</span>，<span class="s2">
7000</span>；铁塔材质类型<span class="s2">Q235</span>，<span
class="s2">Q345</span>，<span
class="s2">Q460</span>每个的价格分别为<span
class="s2">6000</span>，<span class="s2"> 8000</span>，<span class="s2">
10000</span>。我们可以提供的证据包括

每条线路的长度（公里）、材质、并行线路数、包含铁塔数、铁塔材质，这些证据对于该决策非常重要。

  

所属层：输电线路层

  

**Decision 4**

  

三条输电廊道的总占地面积是多少？由于三条输电廊道的规划，需要在现有用地规划的基础上新增多少面积的设施用地<span
class="s2">(facilities)</span>？这里认为输电廊道所在地需要规划为设施用地。

  

所属层：输电廊道层

  

  

**Decision 5**

  

输电廊道内都有哪些树种？分别有多少颗树？平均年龄各是多少？

  

所属层：输电廊道层

  

**Decision 6**

  

有多少颗树会因为修建输电线路而被砍掉？这些树的平均年龄是多少？假定离输电线缆直线距离<span
class="s2">50m</span>内的树要被砍掉。

  

所属层：输电线路层

  

**Decision 7**

  

每个铁塔在出厂时候厂家给出了该铁塔在<span
class="s2">10</span>年内的截面锈蚀率数据（<span class="s2">loss ratio of
sectional area in ten years</span>），请问在<span
class="s2">10</span>年后有多少个铁塔需要更换？假定锈蚀率大于<span
class="s2">0.9</span>的铁塔需要被更换？

  

所属层：输电线路层
